{{- if (eq .chezmoi.os "darwin") -}}
#!/bin/bash

# Avoid re-installing brew if already installed
# Not skipping the entire script since it can upgrade packages too
if ! command -v brew &> /dev/null
then
  echo "Installing homebrew"
# Install homebrew
  curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh
fi

echo "Installing packages and some apps"
brew bundle --no-lock --file=/dev/stdin <<EOF
tap "homebrew/bundle"
tap "homebrew/cask"
tap "homebrew/core"
tap "homebrew/services"
brew "asciiquarium"
brew "bat"
brew "chezmoi"
brew "coreutils"
brew "curl"
brew "fd"
brew "gcc"
brew "git"
brew "jq"
brew "lazygit"
brew "lf"
brew "libyaml"
brew "luajit", args: ["HEAD"]
brew "luarocks"
brew "neovim"
brew "ripgrep"
brew "the_silver_searcher"
brew "tmux"
brew "tree"
brew "universal-ctags"
brew "wget"
brew "zellij"
brew "zsh"
cask "alacritty"
cask "alfred"
cask "beekeeper-studio"
cask "chromedriver"
cask "discord"
cask "flux"
cask "licecap"
cask "ngrok"
cask "rectangle"
cask "visual-studio-code"
EOF

echo "Installing NVM"
if ! command -v nvm &> /dev/null
then
  curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash
fi

echo "

#################################################
Packages and apps installed!

Please change the shell to use homebrew's zsh:
1. add '/usr/local/bin/zsh' to /etc/shells
2. run 'chsh -s /usr/local/bin/zsh

If there are problems with the setup or script:
JOT THE PROBLEM DOWN IN YOUR TODO APP!!!!!
Before you forget.
Your future and past selves thank you.
#################################################

"
{{ end -}}
